<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>OpenMind Interaction API · RegistrationGraph</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">RegistrationGraph</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">RegistrationGraph.jl Documentation</a></li><li><a class="tocitem" href="../graphs/">Graph Construction API</a></li><li class="is-active"><a class="tocitem" href>OpenMind Interaction API</a></li><li><a class="tocitem" href="../postprocessing/">Post-Processing API</a></li><li><a class="tocitem" href="../visualization/">Data Visualization API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>OpenMind Interaction API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>OpenMind Interaction API</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/flavell-lab/RegistrationGraph.jl/blob/master/docs/src/openmind.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="OpenMind-Interaction-API"><a class="docs-heading-anchor" href="#OpenMind-Interaction-API">OpenMind Interaction API</a><a id="OpenMind-Interaction-API-1"></a><a class="docs-heading-anchor-permalink" href="#OpenMind-Interaction-API" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-binding" id="RegistrationGraph.write_sbatch_graph" href="#RegistrationGraph.write_sbatch_graph"><code>RegistrationGraph.write_sbatch_graph</code></a> — <span class="docstring-category">Function</span></header><section><div><p>Syncs data from local computer to a remote server and creates command files for elastix on that server. WARNING: This program can permanently delete data if run with incorrect arguments.</p><p><strong>Arguments</strong></p><ul><li><p><code>edges</code>: List of registration problems to perform</p></li><li><p><code>param_path_fixed::Dict</code>: Dictionary containing paths for the fixed images including:</p><ul><li><code>get_basename</code>: Function that maps channel and time point to MHD filename</li><li><code>path_dir_cmd</code>: Path to elastix command directory</li><li><code>path_om_cmd</code>: Path to elastix command directory on the server</li><li><code>path_om_scripts</code>: Path to directory to store scripts on the server</li><li><code>path_dir_cmd_array</code>: Path to elastix array command directory</li><li><code>path_om_cmd_array</code>: Path to elastix array command directory on the server</li><li><code>path_om_log</code>: Path to log file on server</li><li><code>path_om_tmp</code>: Path to temporary directory on server</li><li><code>path_om_env</code>: Path to script to set environment variables</li><li><code>path_run_elastix</code>: Path to script that runs elastix given command on the server</li><li><code>path_elastix</code>: Path to elastix executable on the server</li><li><code>name_head_rotate_logfile</code>: Name of head rotate log files</li></ul></li><li><p><code>param_path_moving::Dict</code>: Dictionary containing paths for the moving images including the same keys as with the fixed dictionary.</p></li><li><p><code>param::Dict</code>: Dictionary containing parameters including:</p><ul><li><code>email</code>: Email to inform user of task termination. If <code>nothing</code>, no emails will be sent</li><li><code>use_sbatch</code>: Use <code>sbatch</code>, rather than directly running code on the server. This should always be set to <code>true</code> on OpenMind</li><li><code>server_dtn</code>: Address of server to transfer data to</li><li><code>user</code>: Username on server</li><li><code>array_size</code>: Size of <code>sbatch</code> array to use</li><li><code>partition</code>: Priority of jobs on <code>sbatch</code></li></ul></li><li><p><code>data_dir_remote::String</code>: Working directory of data on the remote server.</p></li><li><p><code>img_prefix::String</code>: image prefix not including the timestamp. It is assumed that each frame&#39;s filename    will be, eg, <code>img_prefix_t0123_ch2.mhd</code> for frame 123 with channel=2.</p></li><li><p><code>parameter_files::Array{String,1}</code>: List of parameter files for elastix to use, in order of their application,    as stored on the remote server. These parameter files are NOT assumed to be in the working directory.</p></li><li><p><code>channel::Integer</code>: The channel to use for registration.</p></li><li><p><code>user::String</code>: Username on the server</p></li></ul><p><strong>Optional keyword arguments</strong></p><ul><li><code>clear_cmd_dir::Bool</code>: Whether to clear the elastix command directory, useful if you are re-running registrations</li><li><code>cpu_per_task_key::String</code>: Key in <code>param</code> to CPU cores per elastix task. Default <code>cpu_per_task</code></li><li><code>memory_key::String</code>: Key in <code>param</code> to memory per elastix task. Default <code>memory</code></li><li><code>duration_key::String</code>: Key in <code>param</code> to the duration of each elastix task. Default <code>duration</code></li><li><code>duration_julia_key::String</code>: Key in <code>param</code> to the duration of the Julia script that runs all elastix task. Default <code>duration_julia</code></li><li><code>job_name_key::String</code>: Key in <code>param</code> to the name of the elastix tasks. Default <code>job_name</code></li><li><code>fixed_channel_key::String</code>: Key in <code>param</code> to the fixed channel. Default <code>ch_marker</code></li><li><code>moving_channel_key::String</code>: Key in <code>param</code> to the moving channel. Default <code>ch_marker</code></li><li><code>head_dir_key::String</code>: Key in <code>param_path_*</code> to the head position of the worm. Default <code>path_head_pos</code></li><li><code>om_data_key::String</code>: Key in <code>param_path_*</code> to the path to sync the data on the server. Default <code>path_om_data</code></li><li><code>MHD_dir_key::String</code>: Key in <code>param_path_*</code> to the path to the MHD files. Default <code>path_dir_mhd_filt</code></li><li><code>MHD_om_dir_key::String</code>: Key in <code>param_path_*</code> to the path to the MHD files on the server. Default <code>path_om_mhd_filt</code></li><li><code>mask_dir_key::String</code>: Key in <code>param_path_*</code> to the mask path. Default <code>path_dir_mask</code></li><li><code>mask_om_dir_key::String</code>: Key in <code>param_path_*</code> to the mask path on the server. Default <code>path_om_mask</code></li><li><code>reg_dir_key::String</code>: Key in <code>param_path_*</code> to the registration output directory. Default <code>path_dir_reg</code></li><li><code>reg_om_dir_key::String</code>: Key in <code>param_path_*</code> to the registration output directory on the server. <code>path_om_reg</code></li><li><code>path_head_rotate_key::String</code>: Key in <code>param_path_fixed</code> to the path on the server to the head rotation python file. Default <code>path_head_rotate</code></li><li><code>parameter_files_key::String</code>: Key in <code>param_path_fixed</code> to the path on the server to the elastix parameter files. Default <code>parameter_files</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/flavell-lab/RegistrationGraph.jl/blob/c3bca096ca2b83119ef7a38473089f847e59ae6a/src/run_elastix.jl#L1-L56">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="RegistrationGraph.sync_registered_data" href="#RegistrationGraph.sync_registered_data"><code>RegistrationGraph.sync_registered_data</code></a> — <span class="docstring-category">Function</span></header><section><div><p>Deletes unnecessary files, then syncs registration data from a remote compute server back to the local computer.</p><p><strong>Arguments</strong></p><ul><li><code>param_path::Dict</code>: Dictionary of paths</li><li><code>param::Dict</code>: Dictionary of parameters including:<ul><li><code>user</code>: Username on OpenMind</li><li><code>server_dtn</code>: Data transfer node address on OpenMind</li></ul></li><li><code>reg_dir_key::String</code> (optional, default <code>path_dir_reg</code>): Key in <code>param_path</code> to the path to the registration output directory</li><li><code>reg_om_dir_key::String</code> (optional, default <code>path_om_reg</code>): Key in <code>param_path</code> to the path to the registration output directory on the server</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/flavell-lab/RegistrationGraph.jl/blob/c3bca096ca2b83119ef7a38473089f847e59ae6a/src/run_elastix.jl#L368-L379">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="RegistrationGraph.fix_param_paths" href="#RegistrationGraph.fix_param_paths"><code>RegistrationGraph.fix_param_paths</code></a> — <span class="docstring-category">Function</span></header><section><div><p>Updates parameter paths in transform parameter files, to allow <code>transformix</code> to be run on them. Returns a dictionary of errors per problem and resolution.</p><p><strong>Arguments</strong></p><ul><li><code>problems</code>: Registration problems to update</li><li><code>param_path::Dict</code>: Dictionary of paths including:<ul><li><code>path_root_process</code>: Path to data</li><li><code>path_om_data</code>: Path to data on server</li></ul></li><li><code>param::Dict</code>: Dictionary of parameters</li><li><code>reg_dir_key::String</code> (optional, default <code>path_dir_reg</code>): Key in <code>param_path</code> to the path to the registration output directory</li><li><code>n_resolution_key::String</code> (optional, default <code>reg_n_resolution</code>): Key in <code>param</code> to array of number of registrations with each parameter file</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/flavell-lab/RegistrationGraph.jl/blob/c3bca096ca2b83119ef7a38473089f847e59ae6a/src/run_elastix.jl#L395-L407">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="RegistrationGraph.run_elastix_openmind" href="#RegistrationGraph.run_elastix_openmind"><code>RegistrationGraph.run_elastix_openmind</code></a> — <span class="docstring-category">Function</span></header><section><div><p>Runs elastix on OpenMind. Requires <code>julia</code> to be installed under the relevant username and activated in the default ssh shell. Note that you cannot have multiple instances of this command running simultaneously with the same <code>temp_dir</code>.</p><p><strong>Arguments</strong></p><ul><li><code>param_path::Dict</code>: Dictionary of parameter paths including:<ul><li><code>path_om_tmp</code>: Path to temporary directory on OpenMind.</li><li><code>path_om_cmd</code>: Path to elastix command directory on OpenMind.</li><li><code>path_om_cmd_array</code>: Path to elastix array command directory on OpenMind.</li></ul></li><li><code>param::Dict</code>: Dictionary of parameter settings including:<ul><li><code>user</code>: OpenMind username</li><li><code>server</code>: Login node address on OpenMind</li><li><code>partition</code>: Partition to run elastix using (eg <code>use-everything</code>)</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/flavell-lab/RegistrationGraph.jl/blob/c3bca096ca2b83119ef7a38473089f847e59ae6a/src/run_elastix.jl#L300-L313">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="RegistrationGraph.get_squeue_status" href="#RegistrationGraph.get_squeue_status"><code>RegistrationGraph.get_squeue_status</code></a> — <span class="docstring-category">Function</span></header><section><div><p>Gets the number of running and pending <code>squeue</code> commands from the given user.</p><p><strong>Arguments</strong></p><ul><li><code>param::Dict</code>: Parameter dictionary including:<ul><li><code>user</code>: Username on OpenMind</li><li><code>server</code>: Login node address on OpenMind</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/flavell-lab/RegistrationGraph.jl/blob/c3bca096ca2b83119ef7a38473089f847e59ae6a/src/run_elastix.jl#L334-L341">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="RegistrationGraph.wait_for_elastix" href="#RegistrationGraph.wait_for_elastix"><code>RegistrationGraph.wait_for_elastix</code></a> — <span class="docstring-category">Function</span></header><section><div><p>This function stalls until all the user&#39;s jobs on OpenMind are completed.</p><p><strong>Arguments</strong></p><ul><li><code>param::Dict</code>: Parameter dictionary including:<ul><li><code>user</code>: Username on OpenMind</li><li><code>server</code>: Login node address on OpenMind</li><li><code>elx_wait_delay</code>: Time to wait between checking whether elastix is done, in seconds</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/flavell-lab/RegistrationGraph.jl/blob/c3bca096ca2b83119ef7a38473089f847e59ae6a/src/run_elastix.jl#L350-L358">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../graphs/">« Graph Construction API</a><a class="docs-footer-nextpage" href="../postprocessing/">Post-Processing API »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.8 on <span class="colophon-date" title="Thursday 14 October 2021 20:11">Thursday 14 October 2021</span>. Using Julia version 1.5.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
